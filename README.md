# BESTF: Best Framework for Arduino Testing

BESTF — легковесный фреймворк для тестирования кода на платформе Arduino. Позволяет структурировать тестовые сценарии и получать детализированные результаты выполнения.

Файл FOR_MACRO.h взят от Alex Gyver

### О названии BESTF

BESTF расшифровывается как *Best Framework* — «лучший фреймворк». Ещё одна причина названия — ключевые команды, используемые в работе: **B**, **E**, **S**, **T**, **F**. Они лежат в основе механизма отчётности фреймворка.

## Установка

Для установки фреймворка:

1. Скопируйте все файлы проекта в папку `test`.
2. В файле `platformio.ini` добавьте следующие параметры:
* `test_speed = 9600`
* `test_framework = custom`

Есть простой вариант:

1. Запустите файл `install.py` из любой директории

Рекомендуемый вариант:

1. Перейдите в корень проекта
2. Запустите `git clone http://tui00/bestf.git`
3. Запустите `./bestf/install.py`
4. Следуйте инструкциям на экране

## Описание макросов

### Группа 1: управление жизненным циклом тестов

Эти макросы задают структуру выполнения тестов — определяют, что выполняется до и после их запуска:

* **`START`** — определяет блок кода, который выполнится перед всеми тестами.
* **`NO_START`** — отменяет выполнение предварительного блока кода перед тестами.
* **`STOP`** — определяет блок кода, который выполнится после всех тестов.
* **`NO_STOP`** — отменяет выполнение завершающего блока кода после тестов.
* **`NO_OTHERS`** — одновременно отменяет предварительный и завершающий блоки кода (эквивалентно `NO_START NO_STOP`).

### Группа 2: работа с тестами и отладкой

Макросы для создания тестов, проверки условий и вывода отладочной информации:

* **`TEST(name)`** — создаёт новый тест с указанным именем.
* **`ASSUME(condition)`** — проверяет условие: если оно не выполняется, тест считается проваленным.
* **`END()`** — отмечает успешное завершение теста.
* **`ABORT()`** — принудительно прерывает выполнение теста.
* **`PRINT(...)`** — выводит отладочное сообщение с указанием номера строки.
* **`TESTS_LIST(...)`** — перечисляет тесты, которые нужно запустить (передаются через запятую).

---

## Примеры использования

### Пример 1: с `NO_OTHERS`

```c
#include "bestf.h"

NO_OTHERS

TEST(simple_check) {
    ASSUME(1 + 1 == 2);
    PRINT("Simple math passed");
    END();
}

TESTS_LIST(simple_check)
```

### Пример 2: с `NO_START`

```c
#include "bestf.h"

NO_START

STOP {
    PRINT("All tests completed, cleaning up...");
}

TEST(positive_test) {
    ASSUME(true);
    END();
}

TEST(negative_test) {
    ABORT(); // Тест будет прерван
    END();   // Эта строка не выполнится
}

TESTS_LIST(positive_test, negative_test)
```

### Пример 3: без сокращений

```c
#include "bestf.h"

START {
    PRINT("Initializing test environment...");
}

STOP {
    PRINT("Shutting down test environment.");
}

TEST(division_check) {
    int a = 10, b = 2;
    ASSUME(a / b == 5);
    PRINT("Division test passed");
    END();
}

TEST(string_check) {
    const char* str = "hello";
    ASSUME(str[0] == 'h');
    END();
}

TESTS_LIST(division_check, string_check)
```
